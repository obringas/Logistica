(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{457:(e,t,n)=>{"use strict";n.d(t,{l:()=>s,m:()=>c});var r=n(2109),o=n.n(r);let i=[{id:1,username:"admin",password:"admin123",role:"admin",active:!0,email:"",applicationName:"StockLogistica"},{id:2,username:"juan",password:"juan123",role:"user",active:!0,email:"",applicationName:"StockLogistica"}],a="users_secure",u="claveSegura123456";function s(){let e=localStorage.getItem(a);if(!e)return[...i];try{let t=o().AES.decrypt(e,u).toString(o().enc.Utf8);return JSON.parse(t)}catch(e){return console.warn("❌ Error al desencriptar usuarios, se cargan los iniciales"),[...i]}}function c(e){var t;let n=(t=JSON.stringify(e),o().AES.encrypt(t,u).toString());localStorage.setItem(a,n)}},477:()=>{},1419:(e,t,n)=>{Promise.resolve().then(n.bind(n,4879))},4879:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>u});var r=n(5155),o=n(2115),i=n(5695),a=n(5342);function u(){let e=(0,i.useRouter)();return(0,o.useEffect)(()=>{(0,a.N2)()?(0,a.Zl)(15):e.push("/login")},[]),(0,r.jsx)("div",{children:"Bienvenido"})}},5013:(e,t,n)=>{"use strict";function r(e){a=e}function o(){return a}function i(){a=null}n.d(t,{Rj:()=>r,TW:()=>o,we:()=>i});let a=null;a=function(){let e=document.cookie.split(";").find(e=>e.trim().startsWith("auth_token="));if(!e)return null;try{let t=e.split("=")[1];return JSON.parse(atob(t))}catch(e){return null}}()},5342:(e,t,n)=>{"use strict";n.d(t,{N2:()=>o,VX:()=>i,Zl:()=>a});var r=n(9959);function o(){let e=function(){let e=document.cookie.match(RegExp("(^| )auth_token=([^;]+)"));return e?e[2]:null}();if(!e)return!1;let t=function(e){try{let t=e.split(".")[1];return JSON.parse(atob(t))}catch(e){return console.error("Error al decodificar JWT:",e),null}}(e);if(!(null==t?void 0:t.exp))return!1;let n=1e3*t.exp;return Date.now()<n}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60,n=new Date(Date.now()+6e4*t);document.cookie="auth_token=".concat(e,"; path=/; expires=").concat(n.toUTCString(),"; secure; SameSite=Strict")}function a(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15,n=()=>{console.log("⏰ Sesi\xf3n cerrada por inactividad"),(0,r.ri)()},o=()=>{clearTimeout(e),e=setTimeout(n,6e4*t)};return window.addEventListener("mousemove",o),window.addEventListener("keydown",o),window.addEventListener("click",o),o(),()=>{clearTimeout(e),window.removeEventListener("mousemove",o),window.removeEventListener("keydown",o),window.removeEventListener("click",o)}}},9959:(e,t,n)=>{"use strict";n.d(t,{NM:()=>a,b6:()=>s,ri:()=>u}),n(2109);var r=n(5013),o=n(457),i=n(5342);async function a(e,t){let n=(0,o.l)().find(n=>n.username===e&&n.password===t);if(n){let e=function(e){let t=e=>btoa(JSON.stringify(e)).replace(/=/g,"");return"".concat(t({alg:"HS256",typ:"JWT"}),".").concat(t(e),".signature")}({userId:n.id,userName:n.username,role:n.role||"user",exp:Math.floor(Date.now()/1e3)+900}),t={userId:n.id,userName:n.username,role:n.role||"user",token:e};return localStorage.setItem("user",JSON.stringify(t)),(0,r.Rj)(t),(0,i.VX)(t.token),!0}return!1}function u(){document.cookie="auth_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC",sessionStorage.removeItem("user"),localStorage.removeItem("user"),(0,r.we)(),window.location.href="".concat("/StockLogistica","/login")}function s(e,t,n){let i=(0,o.l)().map(r=>r.id===e?{...r,username:t,password:n}:r);(0,o.m)(i);let a=i.find(t=>t.id===e);if(a){let e={userId:a.id,userName:a.username,role:a.role,token:"",applicationName:"Local"};localStorage.setItem("authUser",JSON.stringify(e)),(0,r.Rj)(e)}}}},e=>{var t=t=>e(e.s=t);e.O(0,[619,441,684,358],()=>t(1419)),_N_E=e.O()}]);