(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{457:(e,t,r)=>{"use strict";r.d(t,{l:()=>l,m:()=>u});var n=r(2109),o=r.n(n);let a=[{id:1,username:"admin",password:"admin123",role:"admin",active:!0,email:"",applicationName:"StockLogistica"},{id:2,username:"juan",password:"juan123",role:"user",active:!0,email:"",applicationName:"StockLogistica"}],s="users_secure",i="claveSegura123456";function l(){let e=localStorage.getItem(s);if(!e)return[...a];try{let t=o().AES.decrypt(e,i).toString(o().enc.Utf8);return JSON.parse(t)}catch(e){return console.warn("❌ Error al desencriptar usuarios, se cargan los iniciales"),[...a]}}function u(e){var t;let r=(t=JSON.stringify(e),o().AES.encrypt(t,i).toString());localStorage.setItem(s,r)}},477:()=>{},5013:(e,t,r)=>{"use strict";function n(e){s=e}function o(){return s}function a(){s=null}r.d(t,{Rj:()=>n,TW:()=>o,we:()=>a});let s=null;s=function(){let e=document.cookie.split(";").find(e=>e.trim().startsWith("auth_token="));if(!e)return null;try{let t=e.split("=")[1];return JSON.parse(atob(t))}catch(e){return null}}()},5342:(e,t,r)=>{"use strict";r.d(t,{N2:()=>o,VX:()=>a,Zl:()=>s});var n=r(9959);function o(){let e=function(){let e=document.cookie.match(RegExp("(^| )auth_token=([^;]+)"));return e?e[2]:null}();if(!e)return!1;let t=function(e){try{let t=e.split(".")[1];return JSON.parse(atob(t))}catch(e){return console.error("Error al decodificar JWT:",e),null}}(e);if(!(null==t?void 0:t.exp))return!1;let r=1e3*t.exp;return Date.now()<r}function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60,r=new Date(Date.now()+6e4*t);document.cookie="auth_token=".concat(e,"; path=/; expires=").concat(r.toUTCString(),"; secure; SameSite=Strict")}function s(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15,r=()=>{console.log("⏰ Sesi\xf3n cerrada por inactividad"),(0,n.ri)()},o=()=>{clearTimeout(e),e=setTimeout(r,6e4*t)};return window.addEventListener("mousemove",o),window.addEventListener("keydown",o),window.addEventListener("click",o),o(),()=>{clearTimeout(e),window.removeEventListener("mousemove",o),window.removeEventListener("keydown",o),window.removeEventListener("click",o)}}},8162:(e,t,r)=>{Promise.resolve().then(r.bind(r,9690))},9690:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var n=r(5155),o=r(2115),a=r(5695),s=r(9959),i=r(5013);function l(){let[e,t]=(0,o.useState)(""),[r,l]=(0,o.useState)(""),[u,c]=(0,o.useState)(""),[d,m]=(0,o.useState)(!1),f=(0,a.useRouter)(),g=async()=>{if(m(!0),c(""),!e||!r){c("Por favor, completa todos los campos."),m(!1);return}let t=await (0,s.NM)(e,r);m(!1),t?(f.push("/dashboard"),console.log("Usuario actual:",(0,i.TW)())):c("Usuario o contrase\xf1a incorrectos")};return(0,n.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-blue-100 to-white",children:(0,n.jsxs)("div",{className:"w-full max-w-sm bg-white shadow-lg rounded-lg p-6",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold text-center mb-4 text-blue-800",children:"Ingreso al sistema"}),u&&(0,n.jsx)("div",{className:"text-red-600 mb-3 text-sm text-center",children:u}),(0,n.jsx)("label",{className:"block text-sm font-medium mb-1 text-gray-700",children:"Usuario"}),(0,n.jsx)("input",{type:"text",className:"w-full border border-gray-300 rounded px-3 py-2 mb-3 focus:outline-none focus:ring-2 focus:ring-blue-400",value:e,onChange:e=>t(e.target.value),disabled:d}),(0,n.jsx)("label",{className:"block text-sm font-medium mb-1 text-gray-700",children:"Contrase\xf1a"}),(0,n.jsx)("input",{type:"password",className:"w-full border border-gray-300 rounded px-3 py-2 mb-4 focus:outline-none focus:ring-2 focus:ring-blue-400",value:r,onChange:e=>l(e.target.value),disabled:d}),(0,n.jsx)("button",{className:"w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 transition ".concat(d?"opacity-50 cursor-not-allowed":""),onClick:g,disabled:d,children:d?"Ingresando...":"Ingresar"})]})})}},9959:(e,t,r)=>{"use strict";r.d(t,{NM:()=>s,b6:()=>l,ri:()=>i}),r(2109);var n=r(5013),o=r(457),a=r(5342);async function s(e,t){let r=(0,o.l)().find(r=>r.username===e&&r.password===t);if(r){let e=function(e){let t=e=>btoa(JSON.stringify(e)).replace(/=/g,"");return"".concat(t({alg:"HS256",typ:"JWT"}),".").concat(t(e),".signature")}({userId:r.id,userName:r.username,role:r.role||"user",exp:Math.floor(Date.now()/1e3)+900}),t={userId:r.id,userName:r.username,role:r.role||"user",token:e};return localStorage.setItem("user",JSON.stringify(t)),(0,n.Rj)(t),(0,a.VX)(t.token),!0}return!1}function i(){document.cookie="auth_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC",sessionStorage.removeItem("user"),localStorage.removeItem("user"),(0,n.we)(),window.location.href="".concat("/StockLogistica","/login")}function l(e,t,r){let a=(0,o.l)().map(n=>n.id===e?{...n,username:t,password:r}:n);(0,o.m)(a);let s=a.find(t=>t.id===e);if(s){let e={userId:s.id,userName:s.username,role:s.role,token:"",applicationName:"Local"};localStorage.setItem("authUser",JSON.stringify(e)),(0,n.Rj)(e)}}}},e=>{var t=t=>e(e.s=t);e.O(0,[619,441,684,358],()=>t(8162)),_N_E=e.O()}]);